<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intent-Driven Telemetry | Network Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Base Canvas Styles */
        body { background-color: #0f172a; color: #f8fafc; font-family: 'Inter', sans-serif; }
        
        /* Node Animations */
        .node-healthy { fill: #10b981; transition: fill 0.3s; }
        .node-healthy:hover { fill: #34d399; filter: drop-shadow(0 0 8px rgba(16, 185, 129, 0.8)); cursor: pointer; }
        
        @keyframes pulse-critical {
            0% { filter: drop-shadow(0 0 4px rgba(239, 68, 68, 0.5)); }
            50% { filter: drop-shadow(0 0 15px rgba(239, 68, 68, 1)); transform: scale(1.1); }
            100% { filter: drop-shadow(0 0 4px rgba(239, 68, 68, 0.5)); }
        }
        .node-critical { fill: #ef4444; transform-origin: center; animation: pulse-critical 2s infinite; cursor: pointer; }
        
        /* Tooltip Glassmorphism */
        .glass-panel {
            background: rgba(30, 41, 59, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
        }

        /* SVG Line Animations */
        .link-default { stroke: #334155; stroke-width: 3; transition: stroke 0.3s, opacity 0.5s; }
        .map-dimmed .link-default { opacity: 0.2; }
        .map-dimmed .node { opacity: 0.3; }
        .map-dimmed .node.active-path { opacity: 1; }

        .trace-path {
            stroke: #06b6d4; /* Cyan glow */
            stroke-width: 4;
            fill: none;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 0 8px rgba(6, 182, 212, 0.8));
            /* Animation setup */
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .trace-active {
            opacity: 1;
            animation: drawPath 1.5s ease-out forwards;
        }

        @keyframes drawPath {
            to { stroke-dashoffset: 0; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col overflow-hidden relative">

    <header class="p-6 border-b border-slate-800 flex justify-between items-center z-10">
        <div>
            <h1 class="text-2xl font-bold tracking-wider">NETWORK <span class="text-blue-500">TELEMETRY</span></h1>
            <p class="text-slate-400 text-sm mt-1">Data Center Fabric View â€¢ Live Topology</p>
        </div>
        <div class="flex gap-4 items-center">
            <span class="flex items-center gap-2 text-sm"><span class="w-3 h-3 rounded-full bg-emerald-500"></span> Nominal</span>
            <span class="flex items-center gap-2 text-sm"><span class="w-3 h-3 rounded-full bg-red-500 animate-pulse"></span> Anomaly Detected</span>
        </div>
    </header>

    <main class="flex-grow relative flex items-center justify-center p-10" id="topologyContainer">
        
        <svg viewBox="0 0 800 500" class="w-full max-w-5xl h-auto overflow-visible z-0" id="networkMap">
            <path class="link-default" d="M 100 250 L 300 150" />
            <path class="link-default" d="M 100 250 L 300 350" />
            <path class="link-default" d="M 300 150 L 500 250" />
            <path class="link-default" d="M 300 350 L 500 250" />
            <path class="link-default" d="M 300 150 L 500 100" />
            <path class="link-default" d="M 500 100 L 700 250" />
            <path class="link-default" d="M 500 250 L 700 250" />

            <path id="activeTrace" class="trace-path" d="M 100 250 L 300 350 L 500 250 L 700 250" />

            <circle cx="100" cy="250" r="16" class="node node-healthy active-path" data-id="pe-1" />
            <text x="100" y="285" fill="#94a3b8" font-size="12" text-anchor="middle">PE-1 (Edge)</text>

            <circle cx="300" cy="150" r="16" class="node node-healthy" data-id="spine-1" />
            <text x="300" y="120" fill="#94a3b8" font-size="12" text-anchor="middle">Spine-01</text>

            <circle cx="300" cy="350" r="16" class="node node-healthy active-path" data-id="spine-2" />
            <text x="300" y="385" fill="#94a3b8" font-size="12" text-anchor="middle">Spine-02</text>

            <circle cx="500" cy="100" r="16" class="node node-healthy" data-id="leaf-1" />
            <text x="500" y="70" fill="#94a3b8" font-size="12" text-anchor="middle">Leaf-01</text>

            <circle cx="500" cy="250" r="16" class="node node-healthy active-path" data-id="leaf-2" />
            <text x="500" y="285" fill="#94a3b8" font-size="12" text-anchor="middle">Leaf-02</text>

            <circle cx="700" cy="250" r="18" class="node node-critical active-path" data-id="pe-2" />
            <text x="700" y="285" fill="#ef4444" font-weight="bold" font-size="14" text-anchor="middle">PE-2 (Issue)</text>
        </svg>

        <div id="telemetryTooltip" class="glass-panel absolute rounded-xl p-5 w-72 text-sm hidden z-20 transition-opacity duration-200 opacity-0 pointer-events-none">
            <div class="flex justify-between items-start mb-3 border-b border-slate-700 pb-3">
                <div>
                    <h3 class="font-bold text-lg text-white" id="tt-name">Node ID</h3>
                    <p class="text-slate-400 text-xs uppercase tracking-wide" id="tt-role">Role</p>
                </div>
                <span id="tt-status-badge" class="px-2 py-1 rounded text-xs font-bold">Status</span>
            </div>
            
            <div class="space-y-2 mb-5">
                <div class="flex justify-between">
                    <span class="text-slate-400">Packet Loss (IP/MPLS):</span>
                    <span class="font-mono text-white" id="tt-loss">0%</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-slate-400">Latency:</span>
                    <span class="font-mono text-white" id="tt-latency">0ms</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-slate-400">Throughput:</span>
                    <span class="font-mono text-white" id="tt-throughput">0 Gbps</span>
                </div>
            </div>

            <button id="traceBtn" class="w-full bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-4 rounded transition-colors hidden pointer-events-auto">
                Trace Traffic Path
            </button>
        </div>

    </main>

    <script>
        // 1. Telemetry Data Structure (Mocking Intent-Driven Data)
        const nodeData = {
            'pe-1': { name: 'PE-Router 01', role: 'Provider Edge', status: 'Optimal', loss: '0.01%', latency: '2.1ms', throughput: '840 Gbps', isDegraded: false },
            'spine-1': { name: 'Spine-01', role: 'Fabric Spine', status: 'Optimal', loss: '0.00%', latency: '0.8ms', throughput: '3.2 Tbps', isDegraded: false },
            'spine-2': { name: 'Spine-02', role: 'Fabric Spine', status: 'Optimal', loss: '0.00%', latency: '0.9ms', throughput: '2.8 Tbps', isDegraded: false },
            'leaf-1': { name: 'Leaf-01', role: 'Fabric Leaf', status: 'Optimal', loss: '0.02%', latency: '1.2ms', throughput: '400 Gbps', isDegraded: false },
            'leaf-2': { name: 'Leaf-02', role: 'Fabric Leaf', status: 'Warning', loss: '1.50%', latency: '45ms', throughput: '380 Gbps', isDegraded: false },
            'pe-2': { name: 'PE-Router 02', role: 'Provider Edge', status: 'Critical', loss: '18.4%', latency: '215ms', throughput: '45 Gbps', isDegraded: true }
        };

        const tooltip = document.getElementById('telemetryTooltip');
        const networkMap = document.getElementById('networkMap');
        const activeTrace = document.getElementById('activeTrace');
        const traceBtn = document.getElementById('traceBtn');
        let hideTimeout;

        // 2. Hover Logic for Progressive Disclosure
        document.querySelectorAll('.node').forEach(nodeEl => {
            nodeEl.addEventListener('mouseenter', (e) => {
                clearTimeout(hideTimeout);
                const id = e.target.getAttribute('data-id');
                const data = nodeData[id];

                // Populate Tooltip
                document.getElementById('tt-name').textContent = data.name;
                document.getElementById('tt-role').textContent = data.role;
                document.getElementById('tt-loss').textContent = data.loss;
                document.getElementById('tt-latency').textContent = data.latency;
                document.getElementById('tt-throughput').textContent = data.throughput;

                const badge = document.getElementById('tt-status-badge');
                badge.textContent = data.status;
                if(data.isDegraded) {
                    badge.className = 'px-2 py-1 rounded text-xs font-bold bg-red-900 text-red-300';
                    document.getElementById('tt-loss').classList.add('text-red-400');
                    document.getElementById('tt-latency').classList.add('text-red-400');
                    traceBtn.classList.remove('hidden');
                } else {
                    badge.className = 'px-2 py-1 rounded text-xs font-bold bg-emerald-900 text-emerald-300';
                    document.getElementById('tt-loss').classList.remove('text-red-400');
                    document.getElementById('tt-latency').classList.remove('text-red-400');
                    traceBtn.classList.add('hidden');
                }

                // Position Tooltip relative to the viewport (near the mouse)
                const rect = e.target.getBoundingClientRect();
                tooltip.style.left = `${rect.left + rect.width + 20}px`;
                tooltip.style.top = `${rect.top - 50}px`;
                
                tooltip.classList.remove('hidden');
                // Small delay for CSS transition
                setTimeout(() => tooltip.classList.remove('opacity-0'), 10);
            });

            nodeEl.addEventListener('mouseleave', () => {
                // Delay hiding so user can move mouse onto the tooltip if needed
                hideTimeout = setTimeout(() => {
                    tooltip.classList.add('opacity-0');
                    setTimeout(() => tooltip.classList.add('hidden'), 200);
                }, 300);
            });
        });

        // Keep tooltip open if hovering over the tooltip itself
        tooltip.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
        tooltip.addEventListener('mouseleave', () => {
            tooltip.classList.add('opacity-0');
            setTimeout(() => tooltip.classList.add('hidden'), 200);
        });

        // 3. Visual Tracing State (On Click)
        traceBtn.addEventListener('click', () => {
            // Dim the background map
            networkMap.classList.add('map-dimmed');
            
            // Hide the tooltip temporarily to focus on the animation
            tooltip.classList.add('opacity-0');
            
            // Trigger the glowing line animation
            activeTrace.classList.add('trace-active');
            
            // Optional: Reset button after 5 seconds to view it again
            setTimeout(() => {
                networkMap.classList.remove('map-dimmed');
                activeTrace.classList.remove('trace-active');
            }, 5000);
        });
    </script>
</body>
</html>
